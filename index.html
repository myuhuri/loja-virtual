<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dior Imports</title>
    <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="header-container">
            <div class="login-container">
                <div class="user-greeting" id="userGreeting" style="display: none;"></div>
                <button id="loginButton" class="btn login-button">Login</button>
                <button id="logoutButton" class="btn logout-button" style="display: none;">Logout</button>
            </div>
            <div class="search-container">
                <input type="text" placeholder="Pesquisar produtos..." id="search" onkeyup="searchProducts()">
            </div>
            <nav class="categories">
                <ul>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle">Maquiagem</a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Batom</a></li>
                            <li><a href="#">Paleta de Sombras</a></li>
                            <li><a href="#">Base</a></li>
                            <li><a href="#">Máscara de Cílios</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle">Feminino</a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Perfumes</a></li>
                            <li><a href="#">Cremes</a></li>
                            <li><a href="#">Tratamentos</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle">Masculino</a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Perfumes</a></li>
                            <li><a href="#">Gel de Banho</a></li>
                            <li><a href="#">Cuidados com a Barba</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle">Cadastro</a>
                        <ul class="dropdown-menu">
                            <li><a href="#" id="clientes-button">Clientes</a></li>
                            <li><a href="#" id="produtos-button">Produtos</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div class="store-name">
                <h1>Dior Imports</h1>
            </div>
            <div class="cart-container">
                <a href="carrinho.html" class="cart-button">
                    <img src="https://img.icons8.com/material-outlined/24/000000/shopping-cart.png" alt="Carrinho">
                    <span class="cart-count" id="cartCount">0</span>
                </a>
            </div>

            <div class="mode-toggle-container">
                <button id="toggle-mode" class="btn">
                    <img src="https://img.icons8.com/ios-filled/24/000000/sun.png" alt="Modo Claro">
                </button>
            </div>
        </div>
    </header>

    <!-- POPUP DE LOGIN -->
    <div id="loginPopup" style="display: none;">
        <div class="login-content">
            <button id="closePopup">&times;</button>
            <h2>Login</h2>
            <form id="loginForm">
                <input type="email" id="email" placeholder="E-mail" required>
                <input type="password" id="password" placeholder="Senha" required>
                <button type="submit" class="btn solid">Entrar</button>
                <button type="button" id="recover-password-button" class="btn clear">Recuperar Senha</button>
                <button type="button" id="register-button" class="btn">Cadastrar</button>
            </form>
        </div>
    </div>

    <!-- POPUP DE CADASTRO DE CLIENTES -->
    <div id="clientesPopup" style="display: none;">
        <div class="login-content">
            <button id="closeClientesPopup">&times;</button>
            <h2>Cadastro de Clientes</h2>
            <form id="clientesForm">
                <input type="text" id="nomeCliente" placeholder="Nome completo" required>
                <input type="text" id="cpfCliente" placeholder="CPF" required>
                <input type="text" id="enderecoCliente" placeholder="Endereço" required>
                <input type="tel" id="telefoneCliente" placeholder="Telefone" required>
                <button type="submit" class="btn solid">Cadastrar Cliente</button>
            </form>
        </div>
    </div>

    <!-- POPUP DE CADASTRO DE PRODUTOS -->
    <div id="produtosPopup" style="display: none;">
        <div class="login-content">
            <button id="closeProdutosPopup">&times;</button>
            <h2>Cadastro de Produtos</h2>
            <form id="produtosForm">
                <input type="text" id="nomeProduto" placeholder="Nome do produto" required>
                <input type="text" id="idProduto" placeholder="ID do produto" required>
                <input type="text" id="categoriaProduto" placeholder="Categoria" required>
                <button type="submit" class="btn solid">Cadastrar Produto</button>
            </form>
        </div>
    </div>

    <section class="featured-products">
        <h2>Mais Vendidos</h2>
        <div class="products">
            <div class="product" data-id="1">
                <img src="https://lojadior.vtexassets.com/arquivos/ids/196323-1200-800/3348901321129_02-highlight-sauvage-edt.jpg?v=638786829193270000" alt="Sauvage Eau de Toilette">
                <h3>Sauvage</h3>
                <p class="price">R$ 1225,00</p>
                <p class="description">Um perfume robusto e elegante, perfeito para o dia a dia.</p>
                <div class="product-actions">
                    <button class="btn add-to-cart">Adicionar ao Carrinho</button>
                    <a href="https://shop.dior.com.br/sauvage-eau-de-parfum/p?skuId=64" class="btn view-more">Ver Mais</a>
                </div>
            </div>
            <div class="product" data-id="2">
                <img src="https://lojadior.vtexassets.com/arquivos/ids/200427-1200-800/3348901571432_02-highlight-md-edp.jpg?v=638836058392300000" alt="Miss Dior">
                <h3>Miss Dior</h3>
                <p class="price">R$ 1039,00</p>
                <p class="description">Delicado e sofisticado, ideal para ocasiões especiais.</p>
                <div class="product-actions">
                    <button class="btn add-to-cart">Adicionar ao Carrinho</button>
                    <a href="https://shop.dior.com.br/new-miss-dior-eau-de-parfum/p?skuId=798" class="btn view-more">Ver Mais</a>
                </div>
            </div>
            <div class="product" data-id="3">
                <img src="https://lojadior.vtexassets.com/arquivos/ids/198944-1200-800/3348901738224_02-highlight-jadore.jpg?v=638799843681300000" alt="J'adore">
                <h3>J'adore</h3>
                <p class="price">R$ 1039,00</p>
                <p class="description">Elegância atemporal, um clássico da perfumaria.</p>
                <div class="product-actions">
                    <button class="btn add-to-cart">Adicionar ao Carrinho</button>
                    <a href="https://shop.dior.com.br/jadore-eau-de-parfum/p?skuId=2511" class="btn view-more">Ver Mais</a>
                </div>
            </div>
            <div class="product" data-id="4">
                <img src="https://lojadior.vtexassets.com/arquivos/ids/200457-1200-800/3348901627375_02-highlight-md-bb.jpg?v=638836058911570000" alt="Miss Dior Blooming Bouquet">
                <h3>MissDior Blooming Bouquet</h3>
                <p class="price">R$ 915,00</p>
                <p class="description">Flores frescas e suaves, um perfume delicado para o verão.</p>
                <div class="product-actions">
                    <button class="btn add-to-cart">Adicionar ao Carrinho</button>
                    <a href="https://shop.dior.com.br/miss-dior-blooming-bouquet/p?skuId=1543" class="btn view-more">Ver Mais</a>
                </div>
            </div>
        </div>
    </section>

    <section class="other-products">
        <h2>Outros Produtos</h2>
        <div class="products">
            <div class="product" data-id="5">
                <img src="https://lojadior.vtexassets.com/arquivos/ids/199149-1200-800/3348900378551_02-highlight-poison.jpg.jpg?v=638799921511700000" alt="Hypnotic Poison">
                <h3>Hypnotic Poison</h3>
                <p class="price">R$ 915,00</p>
                <p class="description">Um perfume oriental arrebatador, incrivelmente sensual.</p>
                <button class="btn add-to-cart">Adicionar ao Carrinho</button>
            </div>
            <div class="product" data-id="6">
                <img src="https://lojadior.vtexassets.com/arquivos/ids/199166-1200-800/3348901654395_02-highlight-LCP.jpg.jpg?v=638802484923500000" alt="Gris Dior">
                <h3>Gris Dior</h3>
                <p class="price">R$ 3.199,00</p>
                <p class="description">Faz uma declaração forte e reconhecível, sempre com elegância.</p>
                <button class="btn add-to-cart">Adicionar ao Carrinho</button>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="social-media">
                <a href="https://www.instagram.com/thaemiillly/?hl=pt-br" class="social-icon">Instagram</a>
                <a href="https://tiktok.com" class="social-icon">TikTok</a>
            </div>
            <div class="contact">
                <p>Contato: thaemillyoliveira@acad.ifma.edu.br</p>
            </div>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBGH_p7RXKwwOvyxuK3TXIlV6qxfSi5tjM",
            authDomain: "dior-imports.firebaseapp.com",
            projectId: "dior-imports",
            storageBucket: "dior-imports.appspot.com",
            messagingSenderId: "927899020114",
            appId: "1:927899020114:web:eba5b8dd55f0e62796288b"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        const loginButton = document.getElementById('loginButton');
        const logoutButton = document.getElementById('logoutButton');
        const userGreeting = document.getElementById('userGreeting');
        const loginPopup = document.getElementById('loginPopup');
        const closePopup = document.getElementById('closePopup');
        const loginForm = document.getElementById('loginForm');
        const registerButton = document.getElementById('register-button');
        const recoverPasswordButton = document.getElementById('recover-password-button');
        const toggleMode = document.getElementById('toggle-mode');
        
        // Elementos do cadastro
        const clientesButton = document.getElementById('clientes-button');
        const produtosButton = document.getElementById('produtos-button');
        const clientesPopup = document.getElementById('clientesPopup');
        const produtosPopup = document.getElementById('produtosPopup');
        const closeClientesPopup = document.getElementById('closeClientesPopup');
        const closeProdutosPopup = document.getElementById('closeProdutosPopup');
        const clientesForm = document.getElementById('clientesForm');
        const produtosForm = document.getElementById('produtosForm');

        // Carrinho de compras
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        // Atualizar contador do carrinho
        function updateCartCount() {
            const count = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // Adicionar ao carrinho
        document.querySelectorAll('.add-to-cart').forEach(button => {
            button.addEventListener('click', function() {
                const productElement = this.closest('.product');
                const product = {
                    id: productElement.dataset.id,
                    name: productElement.querySelector('h3').textContent,
                    price: parseFloat(productElement.querySelector('.price').textContent.replace('R$ ', '').replace('.', '').replace(',', '.')),
                    image: productElement.querySelector('img').src,
                    quantity: 1
                };

                const existingItem = cart.find(item => item.id === product.id);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push(product);
                }

                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                window.location.href = 'carrinho.html';
            });
        });

        // Inicializar contador do carrinho
        updateCartCount();

        // Dropdown menus
        document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
            toggle.addEventListener('click', function(e) {
                e.preventDefault();
                const menu = this.nextElementSibling;
                const isOpen = menu.style.display === 'block';
                
                // Fecha todos os outros menus
                document.querySelectorAll('.dropdown-menu').forEach(m => {
                    if (m !== menu) m.style.display = 'none';
                });
                
                // Abre/fecha o menu atual
                menu.style.display = isOpen ? 'none' : 'block';
            });
        });

        // Fecha menus quando clicar fora
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    menu.style.display = 'none';
                });
            }
        });

        // Restante do código de login/cadastro...
        loginButton.addEventListener('click', () => {
            loginPopup.style.display = 'block';
        });

        closePopup.addEventListener('click', () => {
            loginPopup.style.display = 'none';
        });

        clientesButton.addEventListener('click', (e) => {
            e.preventDefault();
            clientesPopup.style.display = 'block';
        });

        produtosButton.addEventListener('click', (e) => {
            e.preventDefault();
            produtosPopup.style.display = 'block';
        });

        closeClientesPopup.addEventListener('click', () => {
            clientesPopup.style.display = 'none';
        });

        closeProdutosPopup.addEventListener('click', () => {
            produtosPopup.style.display = 'none';
        });

        clientesForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const nome = document.getElementById('nomeCliente').value;
            const cpf = document.getElementById('cpfCliente').value;
            const endereco = document.getElementById('enderecoCliente').value;
            const telefone = document.getElementById('telefoneCliente').value;
            
            database.ref('clientes').push({
                nome: nome,
                cpf: cpf,
                endereco: endereco,
                telefone: telefone,
                timestamp: firebase.database.ServerValue.TIMESTAMP
            }).then(() => {
                alert('Cliente cadastrado com sucesso!');
                clientesForm.reset();
                clientesPopup.style.display = 'none';
            }).catch((error) => {
                alert('Erro ao cadastrar cliente: ' + error.message);
            });
        });

        produtosForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const nome = document.getElementById('nomeProduto').value;
            const idProduto = document.getElementById('idProduto').value;
            const categoria = document.getElementById('categoriaProduto').value;
            
            database.ref('produtos').push({
                nome: nome,
                idProduto: idProduto,
                categoria: categoria,
                timestamp: firebase.database.ServerValue.TIMESTAMP
            }).then(() => {
                alert('Produto cadastrado com sucesso!');
                produtosForm.reset();
                produtosPopup.style.display = 'none';
            }).catch((error) => {
                alert('Erro ao cadastrar produto: ' + error.message);
            });
        });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    loginPopup.style.display = 'none';
                    loginForm.reset();
                })
                .catch((error) => {
                    alert(error.message);
                });
        });

        registerButton.addEventListener('click', () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            if (!email || !password) {
                alert('Por favor, preencha todos os campos para se registrar.');
                return;
            }
            auth.createUserWithEmailAndPassword(email, password)
                .then(() => {
                    alert('Conta criada com sucesso!');
                    loginPopup.style.display = 'none';
                    loginForm.reset();
                })
                .catch((error) => {
                    alert(error.message);
                });
        });

        recoverPasswordButton.addEventListener('click', () => {
            const email = document.getElementById('email').value;
            if (!email) {
                alert('Por favor, insira seu e-mail para recuperar a senha.');
                return;
            }
            auth.sendPasswordResetEmail(email)
                .then(() => {
                    alert('E-mail de recuperação enviado! Verifique sua caixa de entrada.');
                })
                .catch((error) => {
                    alert(error.message);
                });
        });

        logoutButton.addEventListener('click', () => {
            auth.signOut();
        });

        auth.onAuthStateChanged((user) => {
            if (user) {
                loginButton.style.display = 'none';
                logoutButton.style.display = 'block';
                userGreeting.style.display = 'block';
                userGreeting.textContent = `Olá, ${user.email.split('@')[0]}`;
            } else {
                loginButton.style.display = 'block';
                logoutButton.style.display = 'none';
                userGreeting.style.display = 'none';
            }
        });

        toggleMode.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
        });

        // Função de pesquisa
        function searchProducts() {
            const input = document.getElementById('search').value.toLowerCase();
            const allProducts = document.querySelectorAll('.product');

            allProducts.forEach(product => {
                const title = product.querySelector('h3').textContent.toLowerCase();
                const description = product.querySelector('.description')?.textContent.toLowerCase() || '';

                if (title.includes(input) || description.includes(input)) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>